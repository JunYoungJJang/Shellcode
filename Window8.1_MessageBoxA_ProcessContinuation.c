/*
  pushad
  popad to Process
*/

#include <stdio.h>
#include <string.h>

unsigned char shellcode[92] = {
	0x55, 0x8B, 0xEC, 0x60, 0x31, 0xC0, 0x31, 0xDB, 0x31, 0xC9, 0x31, 0xD2,
	0x51, 0x68, 0x6C, 0x6C, 0x20, 0x20, 0x68, 0x33, 0x32, 0x2E, 0x64, 0x68,
	0x75, 0x73, 0x65, 0x72, 0x89, 0xE1, 0xBB, 0x80, 0x8F, 0x65, 0x76, 0x51,
	0xFF, 0xD3, 0xB9, 0x5E, 0x67, 0x30, 0xEF, 0x81, 0xC1, 0x11, 0x11, 0x11,
	0x11, 0x51, 0x68, 0x61, 0x67, 0x65, 0x42, 0x68, 0x4D, 0x65, 0x73, 0x73,
	0x89, 0xE1, 0x51, 0x50, 0xBB, 0x50, 0x7B, 0x65, 0x76, 0xFF, 0xD3, 0x89,
	0xE1, 0x31, 0xD2, 0x52, 0x51, 0x51, 0x52, 0xFF, 0xD0, 0x8D, 0x65, 0xE0,
	0x61, 0x33, 0xC0, 0x8B, 0xE5, 0x5D, 0xC3, 0x00
};

int main(int argc, char **argv)
{
   int (*func)();
   func = (int (*)())shellcode;
   printf("Shellcode Length is : %d",strlen(shellcode));
   (int)(*func)();
};
